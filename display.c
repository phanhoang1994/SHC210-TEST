#include <stdint.h>
#include <stdbool.h>

/* Standard includes. */
#include "inc/hw_memmap.h"
#include "driverlib/gpio.h"

#include "inc/global.h"
#include "inc/display.h"
#include "inc/function.h"

#if (JAPANESE==1)
	/*
	const unsigned int uiStringJapanese1[] = 
	{
		0xFFFE, 0xFFFD, 0xFC13, 0xFDDF, 0xFDD7, 0xFDD8, 0xFDDF, 0x01DF,
		0xDDDF, 0xDDD7, 0xDDD8, 0xDDDF, 0xDC17, 0xDFFB, 0xFFFC, 0x0000,
		0xEF1F, 0xECFF, 0x0000, 0xEBFF, 0xEDFF, 0xF7FE, 0xEA0E, 0xDADD,
		0xBADB, 0x7AD7, 0x780F, 0xBAD7, 0xDADB, 0xEADD, 0xF60E, 0xFFFE,
		0x0000, 0x0000, 0xE03F, 0xEFBF, 0xEFBF, 0xEFBF, 0xEFBF, 0xEFBF,
		0x0000, 0xEFBF, 0xEFBF, 0xEFBF, 0xEFBF, 0xEFBF, 0xE03F, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF
	};
	*/
	
	// kiem tra thang - inspection
	const unsigned int uiStringKiemTraThang[80] = 
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x8000, 0x4000, 0x37C0, 0x0440, 0x0440, 0x1440, 0xE440, 0x047F,
		0x0444, 0x1444, 0xE444, 0x0444, 0x17C4, 0x2004, 0xC000, 0x0000,
		0x0708, 0x00C8, 0xFFFF, 0x0028, 0x0048, 0x8010, 0x8FA8, 0x44A4,
		0x24A2, 0x14A1, 0x0FE1, 0x14A2, 0x24A4, 0x44A8, 0x8F90, 0x8000,
		0x0000, 0x0000, 0x03F8, 0x0208, 0x0208, 0x0208, 0x0208, 0x0208,
		0xFFFF, 0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0x03F8, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	};

	#if(PASSENGER==1)
		// Qua tai tai khach - overload
		const unsigned int uiStringQuaTai[] = 
		{
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x1010, 0x0820, 0x7840, 0x0600, 0x0180, 0x0024, 0x7FA4, 0x00A7,
			0x3CA4, 0x10A4, 0x1FFC, 0x10A4, 0x1CA4, 0x40A7, 0x7FA4, 0x0024,

			0x0000, 0x4000, 0x4000, 0x2FE0, 0x2AA0, 0x0AAF, 0x0AA9, 0x0AA9,
			0x0AA9, 0x0AA9, 0x0AA9, 0x0AA9, 0x2AAF, 0x2FE0, 0x4000, 0x4000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		};
	#else
		// Qua tai tai hang - overload
		const unsigned int uiStringQuaTai[] = 
		{
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x1010, 0x0F10, 0x0814, 0x13FE, 0x2094, 0x4090, 0x4010, 0x4040,
			0x4F20, 0x4914, 0x490C, 0x4924, 0x4944, 0x4944, 0x4F7C, 0x0000,
		
			0x0000, 0x0000, 0x0411, 0x0212, 0x0DF4, 0x1000, 0x27E0, 0x403E,
			0x43A2, 0x42A2, 0x42BA, 0x42AA, 0x4BAA, 0x503E, 0x5FE0, 0x0000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
			0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	 	};
	#endif

	// Dong dat - eqt
	const unsigned int uiStringDongDat[] = 
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x1010, 0x1010, 0x0FFF, 0x0810, 0x0810, 0x0080, 0x0080, 0x3FFE,
		0x4040, 0x4040, 0x41FF, 0x4020, 0x4820, 0x4810, 0x47F0, 0x3000, 
		0x0000,	0x403C, 0x3F84, 0x48B4, 0x4AB4, 0x7AB4, 0x4AB5, 0x4A85, 
		0x2ABF,	0x2A85, 0x1AB5, 0x2AB4, 0x2AB4, 0x4AB4, 0x4884, 0x483C, 
		0x0000,	0x00E0, 0x0028, 0x0027, 0x7FA2, 0x4AAE, 0x4AA2, 0x4AA2, 
		0x4AF8,	0x4AA0, 0x4AA8, 0x4AA7, 0x4BA2, 0x782E, 0x0022, 0x00E2,
		 
		0x0000,	0x0050, 0x1F4C, 0x0148, 0x0148, 0x7FFF, 0x0148, 0x2148, 
		0x1F48,	0x0040, 0x0000, 0x0FFE, 0x4000, 0x7FFF, 0x0000, 0x0000,
		0x8042, 0x4044, 0x3FD8, 0x2040, 0x2004, 0x480B, 0x4BEA, 0x4AAA,
		0x8AAA, 0xBFFF, 0x8AAA, 0x8AAA, 0x8BEA, 0x880A, 0x8006, 0x0000,
		0x0BE8, 0x0AA8, 0x0AA8, 0xFFFF, 0x0AA8, 0x0AA8, 0x0BE8, 0xC000,
		0x7080, 0x4C88, 0x4388, 0x2088, 0x2488, 0x2888, 0x7080, 0x0000,
		0x0000, 0x03F8, 0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0xFFFF,
		0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0x03F8, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	};
	
	// rescue
	const unsigned int uiStringCuuHoMatDien[] = 
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0020, 0x0010, 0xFFF8, 0x0006, 0x0381, 0x0104, 0x0574, 0x4554,
		0x8554, 0x7D57, 0x0554, 0x0554, 0x0574, 0x0104, 0x0300, 0x0000,
		 
		0x003C, 0x0004, 0x1FB4, 0x0AB4, 0x0AB4, 0x0AB5, 0x0A85, 0x7FBF,	
		0x8A85, 0x8AB5, 0x8AB4, 0x8AB4, 0x9FB4, 0x8004, 0x603C, 0x0000,	
		0x00E0, 0x0028, 0x0027, 0x7FA2, 0x4AAE, 0x4AA2, 0x4AA2, 0x4AF8,	
		0x4AA0, 0x4AA8, 0x4AA7, 0x4BA2, 0x782E, 0x0022, 0x00E2,	0x0000,
			
		0x0000,	0x0050, 0x1F4C, 0x0148, 0x0148, 0x7FFF, 0x0148, 0x2148, 
		0x1F48,	0x0040, 0x0000, 0x0FFE, 0x4000, 0x7FFF, 0x0000, 0x0000,
		0x8042, 0x4044, 0x3FD8, 0x2040, 0x2004, 0x480B, 0x4BEA, 0x4AAA,
		0x8AAA, 0xBFFF, 0x8AAA, 0x8AAA, 0x8BEA, 0x880A, 0x8006, 0x0000,
		0x0BE8, 0x0AA8, 0x0AA8, 0xFFFF, 0x0AA8, 0x0AA8, 0x0BE8, 0xC000,
		0x7080, 0x4C88, 0x4388, 0x2088, 0x2488, 0x2888, 0x7080, 0x0000,
		0x0000, 0x03F8, 0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0xFFFF,
		0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0x03F8, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	};
	
	// Bao chay - fireman
	const unsigned int uiStringCuuHoa[] = 
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x8000, 0x4000, 0x2180, 0x1070, 0x0C00, 0x0300, 0x00C0, 0x003F,
		0x01E0, 0x0680, 0x1840, 0x2060, 0x4000, 0x8000, 0x8000, 0x0000, 
		0x8008, 0x8014, 0x8822, 0x4641, 0x2000, 0x1008, 0x0814, 0x0722,	
		0x1C41, 0x1000, 0x2808, 0x4414, 0x8222, 0x8241, 0x0000, 0x0000,	
		0x00E0, 0x0028, 0x0027, 0x7FA2, 0x4AAE, 0x4AA2, 0x4AA2, 0x4AF8,	
		0x4AA0, 0x4AA8, 0x4AA7, 0x4BA2, 0x782E, 0x0022, 0x00E2,	0x0000,
			
		0x0000,	0x0050, 0x1F4C, 0x0148, 0x0148, 0x7FFF, 0x0148, 0x2148, 
		0x1F48,	0x0040, 0x0000, 0x0FFE, 0x4000, 0x7FFF, 0x0000, 0x0000,
		0x8042, 0x4044, 0x3FD8, 0x2040, 0x2004, 0x480B, 0x4BEA, 0x4AAA,
		0x8AAA, 0xBFFF, 0x8AAA, 0x8AAA, 0x8BEA, 0x880A, 0x8006, 0x0000,
		0x0BE8, 0x0AA8, 0x0AA8, 0xFFFF, 0x0AA8, 0x0AA8, 0x0BE8, 0xC000,
		0x7080, 0x4C88, 0x4388, 0x2088, 0x2488, 0x2888, 0x7080, 0x0000,
		0x0000, 0x03F8, 0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0xFFFF,
		0x0208, 0x0208, 0x0208, 0x0208, 0x0208, 0x03F8, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	};
	
	// Thang dang su dung
	const unsigned int uiStringDangSuDung[] = 
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0020, 0x0010, 0xFFFC, 0x0002, 0x87E1, 0x5424, 0x2424, 0x5424,
		0x8FFF, 0x8424, 0x8424, 0x0424, 0x07E0, 0x0000, 0x0000, 0xC000,

		0x3FFF, 0x0421, 0x0421, 0x0421, 0x0421, 0xFFFF, 0x0421, 0x0421,
		0x4421, 0x8421, 0xFFFF, 0x0000, 0x0000, 0x03F8, 0x0208, 0x0208, 
		0x0208, 0x0208, 0x0208,	0xFFFF, 0x0208, 0x0208, 0x0208, 0x0208, 
		0x0208, 0x03F8, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	};

	const unsigned int uiStringTrucTang[]=
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0020, 0x0010, 0xFFF8, 0x0404, 0x0202, 0x0109, 0x0088, 0x0048,
		0x0028, 0xFFFF, 0x0028, 0x0048, 0x0088, 0x0108, 0x0200, 0x0400,
		 
		0x0000, 0x0000, 0x4000, 0x4000, 0x4000, 0x7FC0, 0x4000, 0x4000,
		0x4000, 0x7FFF, 0x4040, 0x4040, 0x4040, 0x4040, 0x4040, 0x4040,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	};

	const unsigned int uiStringTamDung[] =
	{
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0020, 0x0010, 0xFFF8, 0x0006, 0x0381, 0x0104, 0x0574, 0x4554,
		0x8554, 0x7D57, 0x0554, 0x0554, 0x0574, 0x0104, 0x0300, 0x0000,
		 
		0x0000, 0x0000, 0x4000, 0x4000, 0x4000, 0x7FC0, 0x4000, 0x4000,
		0x4000, 0x7FFF, 0x4040, 0x4040, 0x4040, 0x4040, 0x4040, 0x4040,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000,
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	}; //tiengnhat
	 
	const unsigned int uiStringXacLapViTri[73] =  {
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x1FF0, 0x1FF0, 0x0210, 0x0210, 0x0610, 0x09E0, 0x10C0, 0x0000, 				//R
	 	0x1FF0, 0x1FF0, 0x1110, 0x1110, 0x1110, 0x1110, 0x1110, 0x0000,					//E
	 	0x08E0, 0x11F0, 0x1110, 0x1110, 0x1110, 0x1F10, 0x0E20, 0x0000,					//S 	
	 	0x1FF0, 0x1FF0, 0x1110, 0x1110, 0x1110, 0x1110, 0x1110, 0x0000,					//E
	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T	
	 	 		 		
		0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 
		0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	}; 	//Reset

	const unsigned int uiStringXayRaLoi[]; 		//E

	xStringCodeHandler xStringTable[]=					   
	{
		{uiStringTamDung, 64},			//0
		{uiStringTest,32},						//11
	 	{uiStringKiemTraThang, 80},		//1
		{uiStringCuuHoMatDien, 144},	//2
		{uiStringCuuHoa, 144},			//3
		{uiStringXayRaLoi, 0},			//Don't used
		{uiStringQuaTai, 64},			//5
		{uiStringXacLapViTri, 73},		//6
		{uiStringDongDat, 144},			//7
		{uiStringDangSuDung, 80},		//8
		{uiStringTrucTang, 64},			//9
		{uiStringTamDung, 64}, //10
	};
#else
	
	const unsigned int uiStringKiemTraThang[121]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	
	 	0x0100, 0x1FF0, 0x1FF0, 0x1110, 0x1010, 0x1010, 0x0FE0, 0x07C0, 0x0000,			//D	 	
	 	0x1FC0, 0x1FE0, 0x0110, 0x0110, 0x0110, 0x1FE0, 0x1FC0, 0x0000, 				//A
	 	0x1FF0,	0x1FE0, 0x0040, 0x0080, 0x0100, 0x1FF0, 0x1FF0, 0x0000, 				//N
	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1110, 0x1F10, 0x1E20,							//G 
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x1FF0, 0x1FF0, 0x0100, 0x0280, 0x0440, 0x0820, 0x1010, 0x0000, 				//K
	 	0x1FF4,	0x1FF4, 0x0000,															//I
	 	0x1FF0, 0x1FF4, 0x1112, 0x1112, 0x1112, 0x1114, 0x1110, 0x0001,					//E
	 	0x1FF5, 0x1FE3, 0x0040, 0x0080, 0x0040, 0x1FE0, 0x1FF0, 						//M
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T 
	 	0x1FF0, 0x1FF0, 0x0210, 0x0210, 0x0610, 0x09E0, 0x10C0, 0x0000, 				//R
	 	0x1FC0, 0x1FE0, 0x0110, 0x0110, 0x0110, 0x1FE0, 0x1FC0, 0x0000, 				//A
		 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000,
	};																						  
	const unsigned int uiStringTest[48]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	
	 	0xffff, 0x0000, 0x0000, 0xffff, 0x0000, 0x0000, 0xffff, 0x0000, 
		0x0000,0xffff, 0x0000, 0x0000, 0xffff, 0x0000, 0x0000, 0xffff, 	 	
		
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	};																						  
	
	const unsigned int uiStringTamDung[100]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T	 	
	 	0x1FC0, 0x1FE0, 0x4110, 0x4110, 0x4110, 0x1FE0, 0x1FC0, 0x0000,					//A
	 	0x1FF0, 0x1FE0, 0x0040, 0x0080, 0x0040, 0x1FE0, 0x1FF0,  						//M
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x1FF0,	0x1FE0, 0x0040, 0x0080, 0x0100, 0x1FF0, 0x1FF0, 0x0000, 				//N
	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1110, 0x1F10, 0x1E20, 0x0000,					//G 
	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0, 0x000C, 0x0000,			//U
	 	0x1FF0,	0x1FE0, 0x0040, 0x0080, 0x0100, 0x1FF0, 0x1FF0, 0x0000, 				//N
	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1110, 0x1F10, 0x1E20,							//G 
	 		 		 		 			 	
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
	};
	
	const unsigned int uiStringCuuHo[82]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1010, 0x1010, 0x0820, 0x0000,					//C 
	 	0x07F0, 0x0FF0, 0x1004, 0x1004, 0x1002, 0x0FF2, 0x07F0, 0x000C, 0x0000,			//U
	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0,							//U
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x1FF0, 0x1FF0, 0x0100, 0x0100, 0x0100, 0x1FF0, 0x1FF0, 0x0000,					//H
	 	0x07C0, 0x0FE4, 0x5012, 0x5012, 0x5012, 0x0FE4, 0x07C0,							//O
	 		 		 		 	 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
	};
	
	const unsigned int uiStringCuuHoa[83]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1010, 0x1010, 0x0820, 0x0000,					//C 
	 	0x07F0, 0x0FF0, 0x1004, 0x1004, 0x1002, 0x0FF2, 0x07F0, 0x000C, 0x0000,			//U
	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0,							//U
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x1FF0, 0x1FF0, 0x0100, 0x0100, 0x0100, 0x1FF0, 0x1FF0, 0x0000,					//H
	 	0x07C0, 0x0FE0, 0x1011, 0x1015, 0x1013, 0x0FE0, 0x07C0, 0x0000,					//O
	 	0x1FC0, 0x1FE0, 0x0110, 0x0110, 0x0110, 0x1FE0, 0x1FC0,							//A
	 	
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 
		0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
	};
	
	const unsigned int uiStringUuTienCabin[116]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0, 0x000C, 0x0000,			//U
	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0,							//U
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T
	 	0x1FF4,	0x1FF4, 0x0000,															//I
	 	0x1FF0, 0x1FF4, 0x1112, 0x1112, 0x1112, 0x1114, 0x1110, 0x0000,					//E
	 	0x1FF0,	0x1FE0, 0x0040, 0x0080, 0x0100, 0x1FF0, 0x1FF0,							//N
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x07C0, 0x0FE0,	0x1010, 0x1010, 0x1010, 0x1010, 0x0820, 0x0000,					//C 
	 	0x1FC0, 0x1FE0, 0x0110, 0x0110, 0x0110, 0x1FE0, 0x1FC0, 0x0000,					//A
	 	0x1FF0, 0x1FF0, 0x1110, 0x1110, 0x1110, 0x0FE0, 0x06C0, 0x0000, 				//B 	
	 	0x1FF4,	0x1FF4, 0x0000,															//I
	 	0x1FF0,	0x1FE0, 0x0040, 0x0080, 0x0100, 0x1FF0, 0x1FF0, 0x0000, 				//N	
	 	 		 		 		 		 		 		 		 	
		0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 
		0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	};
	
	const unsigned int uiStringQuaTai[78]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x07C0, 0x0FE0, 0x1010, 0x1010, 0x1410, 0x0FE0, 0x17C0, 0x1000,					//Q
	 	0x07F0, 0x0FF0, 0x1000, 0x1000, 0x1000, 0x0FF0, 0x07F0, 0x0000,					//U
	 	0x1FC0, 0x1FE0, 0x0114, 0x0114, 0x0112, 0x1FE2, 0x1FC0, 0x0000,					//A
	 	0x0000, 0x0000, 0x0000, 0x0000, 												//----
	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T
	 	0x1FC0, 0x1FE0, 0x0111, 0x0115, 0x0113, 0x1FE0, 0x1FC0, 0x0000,					//A
	 	0x1FF4,	0x1FF4, 0x0000,															//I
	 	 		 		 		 		 		
		0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 
		0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	};
	
	const unsigned int uiStringReset[73]=
	{
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	 	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,

	 	0x1FF0, 0x1FF0, 0x0210, 0x0210, 0x0610, 0x09E0, 0x10C0, 0x0000, 				//R
	 	0x1FF0, 0x1FF0, 0x1110, 0x1110, 0x1110, 0x1110, 0x1110, 0x0000,					//E
	 	0x08E0, 0x11F0, 0x1110, 0x1110, 0x1110, 0x1F10, 0x0E20, 0x0000,					//S 	
	 	0x1FF0, 0x1FF0, 0x1110, 0x1110, 0x1110, 0x1110, 0x1110, 0x0000,					//E
	 	0x0010, 0x0010, 0x1FF0, 0x1FF0, 0x0010, 0x0010, 0x0000,							//T	
	 	 		 		
		0x0000, 0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 
		0x0000, 0x0000, 0x0000,	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
	};
	
	const unsigned int uiStringDongDat[72];
	const unsigned int uiStringDangSuDung[72];
	
	xStringCodeHandler xStringTable[]=					   
	{
		{uiStringTamDung, 100},			//0
	 	{uiStringKiemTraThang, 121},	//1
		{uiStringCuuHo, 82},			//2
		{uiStringCuuHoa, 83},			//3
		{uiStringUuTienCabin, 116},		//4
		{uiStringQuaTai, 78},			//5
		{uiStringReset, 73},			//6
		{uiStringDongDat, 72},			//7
		{uiStringDangSuDung, 72},		//8
		{uiStringTest,48},						//11
	};

#endif

// Bien phuc vu hien thi led
unsigned long ulNumberDelay;
unsigned long ulArrowDelay;
unsigned long ulStringDelay;

unsigned char ucBlock11;
unsigned char ucBlock12;
unsigned char ucBlock21;
unsigned char ucBlock22;

unsigned long ulBlock1Data[16];
unsigned long ulBlock2Data[16];

unsigned long ulPWMCnt;
extern unsigned long ulPWMSet;

unsigned char ucColumn;
xNumberHandler xNumber;
xArrowHandler xArrow;
xScanHandler xBlock;
xStringHandler xString;
extern xStatusHandler xData;

void (*pvScroll)(void);
void vScanled(void);

extern void vScrollV(void);
extern void vScrollH(void);

extern unsigned char ucScrollNumberV(void);
extern unsigned char ucScrollNumberH(void);
extern unsigned char ucScrollArrowV(void);
extern unsigned char ucScrollArrowH(void);
extern unsigned char ucScrollStringV(void);
extern unsigned char ucScrollStringH(void);

void vDispConfig(void)
{
	unsigned char i=0;
	
	// intinialize
	ucColumn = 0;

	xNumber.ucCur=0;
	xNumber.ucNext=0;
	
	xString.ucStr=0;
	xBlock.pucBlock1=ucScrollNumberV;	
	xBlock.pucBlock2=ucScrollArrowV;

	_clear(xData.ucStatus,DIR_UP);  	//Up
	_clear(xData.ucStatus,DIR_DOWN);	//Down
	_clear(xData.ucStatus,RUN);	//Run

	/* Broadcast Frame: 8byte
		BYTE0: 	NumOfFloor
		BYTE1: 	Display
		BYTE2: 	Status 
				Bit0: Up
				Bit1: Down
				Bit2: Run
				Bit3: Earthquake
				Bit4: Fireman
				Bit5: Overload
				Bit6: Busy
				Bit7: Big digits

		BYTE3: 	Current floor
		BYTE4: 	Unused
		BYTE5: 	Unused
		BYTE6: 	Unused
		BYTE7: 	Unused
	*/
	i = 0;
	//i = 0x4f;
	xData.ucLed7Seg = i;

	i = 0;
	//_set(i,RUN);
	//_set(i,DIR_UP);
	//_set(i,DIR_DOWN);
	//_set(i, EARTHQUAKE);
	//_set(i, FIREMAN);	
	//_set(i, OVERLOAD);
	//_set(i, NHB);	
	xData.ucStatus = i;
	ulPWMSet = HIGHPWM;
	
	pvScroll=vScrollH;
}

void vClearDisp(void)
{
	ucBlock11 = 0xFF;
	ucBlock12 = 0xFF;
	ucBlock21 = 0xFF;
	ucBlock22 = 0xFF;
}

void vDisplay(void)
{
	DWORD tmp;
	volatile unsigned char i;
	
	// if BIG	
	// if(VER == 0){ pvScroll = vScrollV} else { pvScroll = vScrollH;}

	//vClearDisp();

	// nap gia tri vao bo dem	
	if((pvScroll!=0) & (ucColumn==0))
	{
		for(i=0;i<16;i++){ ulBlock1Data[i]=0; ulBlock2Data[i]=0;}
		if(pvScroll!=0) pvScroll();	
		if(xBlock.pucBlock1!=0) xBlock.pucBlock1();
		if(xBlock.pucBlock2!=0) xBlock.pucBlock2();
	}
	// Dao bit cac gia tri vua nap
	tmp.LONG=ulBlock1Data[ucColumn];
	tmp.LONG^=0xFFFFFFFF;
	ucBlock11=tmp.BYTE[1];
	ucBlock12=tmp.BYTE[0];

	tmp.LONG=ulBlock2Data[ucColumn];
	tmp.LONG^=0xFFFFFFFF;
	ucBlock21=tmp.BYTE[1];
	ucBlock22=tmp.BYTE[0]; 

}

void vScanled(void)
{
	DWORD tmp;
	volatile unsigned char i;
	
	vDisplay();

	// All column is off;
	// clear screen
	_write_data(0xFF);
	_latch_col1();

	_write_data(0xFF);
	_latch_col2();	

	_write_data(ucBlock11);
	_latch_block1_1();

	_write_data(ucBlock12);
	_latch_block1_2();

	_write_data(ucBlock21);
	_latch_block2_1();

	_write_data(ucBlock22);
	_latch_block2_2();

	tmp.LONG = 0xFFFFFFFF;
	_clear(tmp.LONG, ucColumn);
 	if(++ulPWMCnt >= HIGHPWM){ ulPWMCnt = 0;}
	if(ulPWMCnt <= ulPWMSet)
	{
		_write_data(tmp.BYTE[0]);
		_latch_col1();

		_write_data(tmp.BYTE[1]);
		_latch_col2();	
	}			
	
	if(++ucColumn>15){ ucColumn = 0;}
}
